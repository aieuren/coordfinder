<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Debug Test Framework</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1e1e1e; color: #d4d4d4; }
        .pass { color: #4ec9b0; }
        .fail { color: #f48771; }
        pre { background: #252526; padding: 10px; border-radius: 3px; margin: 10px 0; }
        h2 { color: #569cd6; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Debug Test Framework</h1>
    <div id="output"></div>
    
    <script src="src/coordfinder.js"></script>
    <script src="src/test-framework.js"></script>
    <script src="src/test-parser.js"></script>
    <script>
        var output = [];
        
        output.push('<h2>1. Check CF loaded</h2>');
        output.push('CF exists: ' + (typeof CF !== 'undefined'));
        output.push('CF.version: ' + (CF ? CF.version : 'N/A'));
        output.push('CF.pointIn exists: ' + (CF && typeof CF.pointIn === 'function'));
        
        output.push('<h2>2. Test CF.pointIn directly</h2>');
        try {
            var testInput = '59.32894 18.06491';
            output.push('Input: "' + testInput + '"');
            var point = CF.pointIn(testInput);
            output.push('Result: ' + point);
            if (point) {
                output.push('Latitude: ' + point.latitude());
                output.push('Longitude: ' + point.longitude());
            } else {
                output.push('<span class="fail">ERROR: pointIn returned null!</span>');
            }
        } catch(e) {
            output.push('<span class="fail">ERROR: ' + e.message + '</span>');
        }
        
        output.push('<h2>3. Check TestFramework</h2>');
        output.push('TestFramework exists: ' + (typeof TestFramework !== 'undefined'));
        output.push('TestFramework.PointTest exists: ' + (TestFramework && typeof TestFramework.PointTest === 'function'));
        
        output.push('<h2>4. Check MarkdownTestParser</h2>');
        output.push('MarkdownTestParser exists: ' + (typeof MarkdownTestParser !== 'undefined'));
        
        output.push('<h2>5. Parse simple test</h2>');
        try {
            var testMd = '# Test Suite\n\n## Point Test: Simple test\nTest-ID: test-001\nInput: "59.32894 18.06491"\nExpected:\n- Coords: 59.32894 18.06491\n';
            output.push('Test markdown:');
            output.push('<pre>' + testMd + '</pre>');
            
            var parser = new MarkdownTestParser();
            var suites = parser.parse(testMd);
            output.push('Parsed suites: ' + suites.length);
            
            if (suites.length > 0) {
                output.push('Suite name: ' + suites[0].name);
                output.push('Tests in suite: ' + suites[0].tests.length);
                
                if (suites[0].tests.length > 0) {
                    var test = suites[0].tests[0];
                    output.push('Test ID: ' + test.id);
                    output.push('Test name: ' + test.name);
                    output.push('Test input: "' + test.input + '"');
                    output.push('Test expected: "' + test.expected + '"');
                    
                    output.push('<h2>6. Run the test</h2>');
                    var result = test.run();
                    output.push('Test passed: ' + result.passed);
                    output.push('Test message: ' + result.message);
                    if (result.actual !== undefined) {
                        output.push('Actual: ' + result.actual);
                    }
                    if (result.expected !== undefined) {
                        output.push('Expected: ' + result.expected);
                    }
                }
            }
        } catch(e) {
            output.push('<span class="fail">ERROR: ' + e.message + '</span>');
            output.push('<pre>' + e.stack + '</pre>');
        }
        
        document.getElementById('output').innerHTML = output.join('<br>');
    </script>
</body>
</html>

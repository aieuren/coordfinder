<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TDD Test Runner</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        .test { padding: 10px; margin: 5px 0; border-radius: 3px; }
        .pass { background: #1e4620; border-left: 4px solid #4ec9b0; }
        .fail { background: #5a1d1d; border-left: 4px solid #f48771; }
        .error { color: #f48771; margin-left: 20px; }
        .summary { margin-top: 20px; padding: 15px; background: #252526; border-radius: 5px; }
        h1 { color: #4ec9b0; }
        h2 { color: #569cd6; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>TDD Test Runner</h1>
    <div id="results"></div>
    
    <script src="../src/coordfinder.js"></script>
    <script>
        var results = [];
        
        function test(id, name, input, expectedLat, expectedLon) {
            try {
                var point = CF.pointIn(input);
                
                if (!point) {
                    results.push({
                        id: id,
                        name: name,
                        pass: false,
                        error: 'No point found'
                    });
                    return;
                }
                
                var lat = point.latitude();
                var lon = point.longitude();
                
                var latMatch = Math.abs(lat - expectedLat) < 0.00001;
                var lonMatch = Math.abs(lon - expectedLon) < 0.00001;
                
                if (latMatch && lonMatch) {
                    results.push({
                        id: id,
                        name: name,
                        pass: true
                    });
                } else {
                    results.push({
                        id: id,
                        name: name,
                        pass: false,
                        error: 'Expected: ' + expectedLat + ' ' + expectedLon + 
                               ', Got: ' + lat + ' ' + lon
                    });
                }
            } catch(e) {
                results.push({
                    id: id,
                    name: name,
                    pass: false,
                    error: 'Exception: ' + e.message
                });
            }
        }
        
        // === GRUNDLÄGGANDE WGS84 DECIMALGRADER ===
        test('tdd-001', 'Enkel decimalform', '59.32894 18.06491', 59.32894, 18.06491);
        test('tdd-002', 'Decimalkomma', '59,32894 18,06491', 59.32894, 18.06491);
        test('tdd-003', 'Semikolon som separator', '59.32894; 18.06491', 59.32894, 18.06491);
        
        // === GRADER OCH MINUTER ===
        test('tdd-004', 'Grader och decimalminuter', '59° 19.736\' N 18° 3.895\' E', 59.32893, 18.06492);
        test('tdd-005', 'Grader, minuter och sekunder', '59° 19\' 44.2" N 18° 3\' 53.7" E', 59.32894, 18.06492);
        test('tdd-006', 'Kompakt DMS format', '591944N0180354E', 59.32889, 18.06500);
        
        // === VÄDERSTRECK OCH KVADRANTER ===
        test('tdd-007', 'Väderstreck före värden', 'N 62.45 E 17.38', 62.45, 17.38);
        test('tdd-008', 'Sydvästra kvadranten', 'S 33.92 W 18.42', -33.92, -18.42);
        test('tdd-009', 'Svenska väderstreck', 'N 65.58 Ö 22.14', 65.58, 22.14);
        
        // === MINUSTECKEN SOM SEPARATOR ===
        test('tdd-010', 'Grader-minuter format', '58-30 16-45', 58.50, 16.75);
        test('tdd-011', 'Kompakt gradminut', '6230-1545', 62.50, 15.75);
        
        console.log('Tests completed. Results:');
        console.log('Passed:', results.filter(function(r) { return r.pass; }).length);
        console.log('Failed:', results.filter(function(r) { return !r.pass; }).length);
        
        // Display results
        var html = '';
        var passed = 0;
        var failed = 0;
        
        html += '<h2>Grundläggande WGS84 Decimalgrader</h2>';
        for (var i = 0; i < 3; i++) {
            var r = results[i];
            html += '<div class="test ' + (r.pass ? 'pass' : 'fail') + '">';
            html += (r.pass ? '✓' : '✗') + ' [' + r.id + '] ' + r.name;
            if (r.error) html += '<div class="error">' + r.error + '</div>';
            html += '</div>';
            if (r.pass) passed++; else failed++;
        }
        
        html += '<h2>Grader och Minuter</h2>';
        for (var i = 3; i < 6; i++) {
            var r = results[i];
            html += '<div class="test ' + (r.pass ? 'pass' : 'fail') + '">';
            html += (r.pass ? '✓' : '✗') + ' [' + r.id + '] ' + r.name;
            if (r.error) html += '<div class="error">' + r.error + '</div>';
            html += '</div>';
            if (r.pass) passed++; else failed++;
        }
        
        html += '<h2>Väderstreck och Kvadranter</h2>';
        for (var i = 6; i < 9; i++) {
            var r = results[i];
            html += '<div class="test ' + (r.pass ? 'pass' : 'fail') + '">';
            html += (r.pass ? '✓' : '✗') + ' [' + r.id + '] ' + r.name;
            if (r.error) html += '<div class="error">' + r.error + '</div>';
            html += '</div>';
            if (r.pass) passed++; else failed++;
        }
        
        html += '<h2>Minustecken som Separator</h2>';
        for (var i = 9; i < 11; i++) {
            var r = results[i];
            html += '<div class="test ' + (r.pass ? 'pass' : 'fail') + '">';
            html += (r.pass ? '✓' : '✗') + ' [' + r.id + '] ' + r.name;
            if (r.error) html += '<div class="error">' + r.error + '</div>';
            html += '</div>';
            if (r.pass) passed++; else failed++;
        }
        
        html += '<div class="summary">';
        html += '<strong>Summary:</strong> ' + passed + ' passed, ' + failed + ' failed, ' + results.length + ' total<br>';
        html += '<strong>Pass rate:</strong> ' + Math.round((passed / results.length) * 100) + '%';
        html += '</div>';
        
        document.getElementById('results').innerHTML = html;
    </script>
</body>
</html>

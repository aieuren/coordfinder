<!DOCTYPE html>
<html>
<head><meta charset="UTF-8"><title>TDD Test Results</title>
<style>
body{font-family:monospace;padding:20px;background:#000;color:#0f0;}
.pass{color:#0f0;} .fail{color:#f00;} .section{margin:20px 0;border-top:1px solid #333;padding-top:10px;}
</style>
</head>
<body>
<h1>TDD Test Results</h1>
<pre id="out"></pre>
<script src="src/coordfinder.js"></script>
<script>
var log = [];
var passed = 0, failed = 0;

function test(id, name, input, expectedLat, expectedLon) {
    try {
        var point = CF.pointIn(input);
        if (!point) {
            log.push('<span class="fail">✗ ' + id + ': ' + name + ' - NO POINT FOUND</span>');
            failed++;
            return false;
        }
        
        var lat = point.latitude();
        var lon = point.longitude();
        var latOk = Math.abs(lat - expectedLat) < 0.00001;
        var lonOk = Math.abs(lon - expectedLon) < 0.00001;
        
        if (latOk && lonOk) {
            log.push('<span class="pass">✓ ' + id + ': ' + name + '</span>');
            passed++;
            return true;
        } else {
            log.push('<span class="fail">✗ ' + id + ': ' + name + '</span>');
            log.push('  Expected: ' + expectedLat.toFixed(5) + ', ' + expectedLon.toFixed(5));
            log.push('  Got:      ' + lat.toFixed(5) + ', ' + lon.toFixed(5));
            failed++;
            return false;
        }
    } catch(e) {
        log.push('<span class="fail">✗ ' + id + ': ' + name + ' - ERROR: ' + e.message + '</span>');
        failed++;
        return false;
    }
}

log.push('<div class="section"><strong>=== GRUNDLÄGGANDE WGS84 DECIMALGRADER ===</strong></div>');
test('tdd-001', 'Enkel decimalform', '59.32894 18.06491', 59.32894, 18.06491);
test('tdd-002', 'Decimalkomma', '59,32894 18,06491', 59.32894, 18.06491);
test('tdd-003', 'Semikolon som separator', '59.32894; 18.06491', 59.32894, 18.06491);

log.push('<div class="section"><strong>=== GRADER OCH MINUTER ===</strong></div>');
test('tdd-004', 'Grader och decimalminuter', '59° 19.736\' N 18° 3.895\' E', 59.32893, 18.06492);
test('tdd-005', 'Grader, minuter och sekunder', '59° 19\' 44.2" N 18° 3\' 53.7" E', 59.32894, 18.06492);
test('tdd-006', 'Kompakt DMS format', '591944N0180354E', 59.32889, 18.06500);

log.push('<div class="section"><strong>=== VÄDERSTRECK OCH KVADRANTER ===</strong></div>');
test('tdd-007', 'Väderstreck före värden', 'N 62.45 E 17.38', 62.45, 17.38);
test('tdd-008', 'Sydvästra kvadranten', 'S 33.92 W 18.42', -33.92, -18.42);
test('tdd-009', 'Svenska väderstreck', 'N 65.58 Ö 22.14', 65.58, 22.14);

log.push('<div class="section"><strong>=== MINUSTECKEN SOM SEPARATOR ===</strong></div>');
test('tdd-010', 'Grader-minuter format', '58-30 16-45', 58.50, 16.75);
test('tdd-011', 'Kompakt gradminut', '6230-1545', 62.50, 15.75);

log.push('<div class="section"><strong>=== URL-FORMAT ===</strong></div>');
test('tdd-012', 'Google Maps URL', 'https://www.google.com/maps/@59.32894,18.06491', 59.32894, 18.06491);
test('tdd-013', 'Eniro-stil URL', 'map/59.329440/18.064510', 59.32944, 18.06451);

log.push('<div class="section"><strong>=== DATAFORMAT ===</strong></div>');
test('tdd-014', 'GeoJSON', '{"coordinates": [18.06491, 59.32894]}', 59.32894, 18.06491);
test('tdd-015', 'GML', '<gml:pos>59.32894 18.06491</gml:pos>', 59.32894, 18.06491);

log.push('<div class="section"><strong>=== PREFIX ===</strong></div>');
test('tdd-025', 'Lat/Long prefix', 'Lat: 61.234567 Long: 15.876543', 61.234567, 15.876543);

log.push('<div class="section"><strong>=== KOMPAKT/GLEST ===</strong></div>');
test('tdd-023', 'Very compact DM', '5830N01245E', 58.50, 12.75);
test('tdd-024', 'Mycket glest format', '58  °  30  \'  N    12  °  45  \'  E', 58.50, 12.75);

log.push('<div class="section"><strong>=== WKT ===</strong></div>');
test('tdd-036', 'WKT POINT', 'POINT(18.06491 59.32894)', 59.32894, 18.06491);

log.push('<div class="section"><strong>=== SAMMANFATTNING ===</strong></div>');
log.push('<strong>Passed: ' + passed + '</strong>');
log.push('<strong>Failed: ' + failed + '</strong>');
log.push('<strong>Total:  ' + (passed + failed) + '</strong>');
log.push('<strong>Rate:   ' + Math.round((passed/(passed+failed))*100) + '%</strong>');

document.getElementById('out').innerHTML = log.join('\n');
</script>
</body>
</html>
